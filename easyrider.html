<!DOCTYPE html>

<!-- easyrider.html
     created 20111202
  -->

<html>
 <head>
  <title>Easy Rider</title>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <style type="text/css">
    html { height: 100% }
    body { height: 100%; marginl: 0; padding: 0 }
    #map_canvas { height: 100% }
  </style>

  <script type="text/javascript"
    src="http://maps.googleapis.com/maps/api/js?key=AIzaSyCC5EVLne7LJHdAVBnLY6Ve6gPku049fG8&sensor=false">
  </script>

  <script type="text/javascript">
    //Global Script Variables
    var markers = [];

    var map = null;

    function initialize()
    {
      var latlng = new google.maps.LatLng(42.25, -71.85);

      var myOptions = {
        zoom: 12,
        center: latlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP
      };

      map = new google.maps.Map(document.getElementById("map_canvas"),
        myOptions);

      //Add a listener to respond to clicks on the map.
      google.maps.event.addListener(
          map
        , 'click'
        , function(event)
          {
            addMarker(event.latLng, true);
          }
        ) ;

      //Add a listener to remove a marker with a double-click

    }

    //Add a marker to the map. This has a limit as not to overflow the
    //courtesy request limit offered by Google.
    function addMarker(latlng, doQuery)
    {
      if (markers.length < 10)
      {
        var marker = new google.maps.Marker({
            animation: google.maps.Animation.DROP
          , position: latlng
          , map: map
          , draggable: true
          } );

        google.maps.event.addListener(
            marker
          , 'dragend'
          , function(e) {
              updateElevation();
            }
          ) ;

        markers.push(marker);

        if (doQuery) {
          updateElevation();
        }

        if (markers.length == 10) {
          document.getElementById('address').disabled = true;
        }
      } else {
        alert("Only upto 10 markers can be added in this demo.");
      }
    }

    //Call addAddress() if the Return key is pressed in the address field.
    function addressKeyHandler(evt) {
      var keycode;

      if (window.event) {
        keycode = window.event.keyCode;
      } else if (evt) {
        keycode = evt.which;
      } else {
        return true;
      }

      if (keycode == 13) {
        addAddress();
        return false;
      } else {
        return true;
      }
    }


  </script>

  <script type="text/javascript" src="https://www.google.com/jsapi"></script>

  <script type="text/javascript">
    // Nate's script for elevation chart
    // array elevations needs to be include elevations from marker clicks
    google.load("visualization", "1", {packages:["corechart"]});
    google.setOnLoadCallback(drawChart);

    function drawChart() {

      var elevations=new Array(); 

      elevations[0]=700;       
      elevations[1]=500;
      elevations[2]=550;
    
      var data = new google.visualization.DataTable();

      data.addColumn('number', 'position');
      data.addColumn('number', 'elevation');

      var i=0;

      for (i=0; i < elevations.length; i++){
        data.addRow([i, elevations[i]]);
      }

      var chart = new google.visualization.LineChart(
        document.getElementById('chart_div'));

      chart.draw(data, {colors:['black','red'], legend:'none'});
    }

    </script>

 </head>

 <body onload="initialize()">
  <div id="map_canvas"
       style="border: 1px solid black; width:512px; height:400px"></div>

  <p>Address: <input type="text"
                     id="address"
                     size="15"
                     onkeypress="return addressKeyHandler(event)"/>
  </p>

  <div id="chart_div" style="width:512px"></div>
 </body>
</html>
